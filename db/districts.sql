BEGIN;

-- 1) Временная таблица‑справочник
--CREATE TEMP TABLE district_to_ao (
 -- district_name TEXT PRIMARY KEY,
 ---- admin_okrug   TEXT       NOT NULL
--);

-- 2) Наполняем справочник значениями для всех ваших районов
INSERT INTO district_to_ao(district_name, admin_okrug) VALUES
  ('район Чертаново Северное',      'ЮАО'),
  ('район Дмитровский',             'САО'),
  ('район Академический',           'СВАО'),
  ('район Левобережный',            'СВАО'),
  ('район поселение Сосенское',     'ТиНАО'),
  ('район Раменки',                 'ЗАО'),
  ('район Ивановское',              'ЮВАО'),
  ('район поселение Михайлово-Ярцевское','ТиНАО'),
  ('район Преображенское',          'СВАО'),
  ('район Проспект Вернадского',    'ЗАО'),
  ('район Филевский парк',          'ЗАО'),
  ('район Котловка',                'ЮЗАО'),
  ('район поселение Киевский',      'ТиНАО'),
  ('район поселение Щаповское',     'ТиНАО'),
  ('район Тропарево-Никулино',      'ЮЗАО'),
  ('район Строгино',                'СЗАО'),
  ('район Марьино',                 'ЮВАО'),
  ('район Даниловский',             'ЮАО'),
  ('район Теплый Стан',             'ЮЗАО'),
  ('район Восточный',               'ВАO'),
  ('район Косино-Ухтомский',        'ВАО'),
  ('район Нагатинский затон',       'ЮАО'),
  ('район Южное Бутово',            'ЮЗАО'),
  ('район Сокол',                   'САО'),
  ('район Рязанский',               'ЮВАО'),
  ('район Вороново',                'ТиНАО'),
  ('район Нижегородский',           'ЮВАО'),
  ('район Якиманка',                'ЦАО'),
  ('район поселение Внуковское',    'ТиНАО'),
  ('район поселение Марушкинское',  'ТиНАО'),
  ('район Крюково',                 'ЗелАО'),
  ('район Таганский',               'ЦАО'),
  ('район Новогиреево',             'ВАО'),
  ('район Чертаново Центральное',   'ЮАО'),
  ('район Сокольники',              'СВАО'),
  ('район Кунцево',                 'ЗАО'),
  ('район Филимонковский',          'ТиНАО'),
  ('район Ростокино',               'СВАО'),
  ('район поселение Кокошкино',     'ТиНАО'),
  ('район Очаково-Матвеевское',     'ЗАО'),
  ('район поселение Десеновское',   'ТиНАО'),
  ('район поселение Первомайское',  'ТиНАО'),
  ('район Гольяново',               'ВАО'),
  ('район Царицыно',                'ЮАО'),
  ('район Митино',                  'СЗАО'),
  ('район Метрогородок',            'СВАО'),
  ('район Хорошевский',             'САО'),
  ('район Останкинский',            'СВАО'),
  ('район Силино',                  'ЗелАО'),
  ('район Вешняки',                 'ВАО'),
  ('район Ново-Переделкино',        'ЗАО'),
  ('район Бибирево',                'СВАО'),
  ('район Соколиная гора',          'СВАО'),
  ('район Замоскворечье',           'ЦАО'),
  ('район Коньково',                'ЮЗАО'),
  ('район Отрадное',                'СВАО'),
  ('район Северное Медведково',     'СВАО'),
  ('район Ясенево',                 'ЮЗАО'),
  ('район Бекасово',                'ТиНАО'),
  ('район Новокосино',              'ВАО'),
  ('район Бутырский',               'САО'),
  ('район Кузьминки',               'ЮВАО'),
  ('район Чертаново Южное',         'ЮАО'),
  ('район Гагаринский',             'ЮЗАО'),
  ('район Москворечье-Сабурово',    'ЮАО'),
  ('район Перово',                  'ВАО'),
  ('район Марфино',                 'СВАО'),
  ('район Куркино',                 'САО'),
  ('район Свиблово',                'СВАО'),
  ('район Зюзино',                  'ЮЗАО'),
  ('район Красносельский',          'ЦАО'),
  ('район Алтуфьевский',            'СВАО'),
  ('район Савеловский',             'САО'),
  ('район городской округ Троицк',  'ТиНАО'),
  ('район Люблино',                 'ЮВАО'),
  ('район Бескудниковский',         'САО'),
  ('район Аэропорт',                'САО'),
  ('район Алексеевский',            'СВАО'),
  ('район Можайский',               'ЗАО'),
  ('район Южнопортовый',            'ЮВАО'),
  ('район Тимирязевский',           'САО'),
  ('район Богородское',             'ВАО'),
  ('район Орехово-Борисово Северное','ЮАО'),
  ('район Восточное Измайлово',     'ВАО'),
  ('район Матушкино',               'ЗелАО'),
  ('район Южное Тушино',            'СЗАО'),
  ('район Крылатское',              'ЗАО'),
  ('район Выхино-Жулебино',         'ЮВАО'),
  ('район Тверской',                'ЦАО'),
  ('район Бабушкинский',            'СВАО'),
  ('район Восточное Дегунино',      'САО'),
  ('район Краснопахорский',         'ТиНАО'),
  ('район Текстильщики',            'ЮВАО'),
  ('район Бирюлево Восточное',      'ЮАО'),
  ('район Бирюлево Западное',       'ЮАО'),
  ('район Южное Медведково',        'СВАО'),
  ('район Лосиноостровский',        'СВАО'),
  ('район Хорошево-Мневники',       'СЗАО'),
  ('район Мещанский',               'ЦАО'),
  ('район Ярославский',             'СВАО'),
  ('район Щукино',                  'СЗАО'),
  ('район Коммунарка',              'ТиНАО'),
  ('район Западное Дегунино',       'САО'),
  ('район Войковский',              'САО'),
  ('район Басманный',               'ЦАО'),
  ('район Орехово-Борисово Южное',  'ЮАО'),
  ('район Черемушки',               'ЮАО'),
  ('район поселение Роговское',     'ТиНАО'),
  ('район Зябликово',               'ЮАО'),
  ('район Марьина роща',            'СВАО'),
  ('район Обручевский',             'ЮЗАО'),
  ('район Молжаниновский',          'САО'),
  ('район Беговой',                 'САО'),
  ('район Печатники',               'ЮВАО'),
  ('район Головинский',             'САО'),
  ('район Хамовники',               'ЦАО'),
  ('район Покровское-Стрешнево',    'СЗАО'),
  ('район Северное Бутово',         'ЮЗАО'),
  ('район поселение Рязановское',   'ТиНАО'),
  ('район Пресненский',             'ЦАО'),
  ('район Ховрино',                 'САО'),
  ('район Северное Тушино',         'СЗАО'),
  ('район Лианозово',               'СВАО'),
  ('район Нагатино-Садовники',      'ЮАО'),
  ('район поселение Филимонковское','ТиНАО'),
  ('район Северное Измайлово',      'ВАО'),
  ('район Арбат',                   'ЦАО'),
  ('район Старое Крюково',          'СЗАО'),
  ('район Внуково',                 'ТиНАО'),
  ('район Нагорный',                'ЮЗАО'),
  ('район Северный',                'САО'),
  ('район Солнцево',                'ЗАО'),
  ('район Донской',                 'ЮАО'),
  ('район Некрасовка',              'ЮВАО'),
  ('район Братеево',                'ЮАО'),
  ('район Капотня',                 'ЮВАО'),
  ('район Лефортово',               'СВАО'),
  ('район Коптево',                 'САО'),
  ('район Фили-Давыдково',          'ЗАО'),
  ('район Дорогомилово',            'ЗАО'),
  ('район Измайлово',               'ВАО'),
  ('район поселение "Мосрентген"','ТиНАО'),
  ('район Ломоносовский',           'САО')
;

-- 3) Обновляем основной справочник
UPDATE districts d
SET admin_okrug = m.admin_okrug
FROM district_to_ao m
WHERE d.name = m.district_name;

-- 4) Удаляем временный справочник
DROP TABLE district_to_ao;

COMMIT;
